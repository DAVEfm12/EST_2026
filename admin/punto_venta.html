<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <title>POS Elite Pro | LK Studio</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.1.1/animate.min.css">
    <style>
        :root { 
            --gold: #D4AF37; 
            --gold-bright: #FFD700; 
            --rose-gold: #E6B8A2; 
            --deep-black: #050505;
        }

        body { 
            background: radial-gradient(circle at top, #1a1a1a, var(--deep-black)); 
            color: #ffffff; 
            font-family: 'Poppins', sans-serif; 
            min-height: 100vh; 
        }

        .card { 
            background: rgba(10, 10, 10, 0.9); 
            border: 1px solid var(--gold); 
            border-radius: 1.5rem; 
            box-shadow: 0 10px 30px rgba(0,0,0,0.8);
        }

        .gold { color: var(--gold) !important; }
        .golden-rose { color: var(--rose-gold) !important; }
        label { color: var(--rose-gold) !important; letter-spacing: 1px; margin-bottom: 5px; font-size: 0.75rem; font-weight: bold; }

        .btn-gold { 
            background: linear-gradient(45deg, var(--gold), #f3cf58); 
            color: #000 !important; 
            font-weight: 800; 
            border: none; 
            border-radius: 10px; 
            text-transform: uppercase;
        }

        .form-control, .form-select { 
            background: #000 !important; 
            border: 1px solid #444 !important; 
            color: #ffffff !important; 
        }

        /* Estilo Ticket Modal */
        #ticketPreview {
            background: #fff;
            color: #000;
            font-family: 'Courier New', Courier, monospace;
            padding: 20px;
            border-radius: 5px;
            font-size: 0.85rem;
            line-height: 1.2;
        }

        .logo-ticket {
            max-width: 120px;
            display: block;
            margin: 0 auto 10px;
            filter: grayscale(100%) contrast(150%);
        }

        .btn-whatsapp {
            background-color: #25D366;
            color: white !important;
            font-weight: 800;
            border: none;
            border-radius: 10px;
        }

        .stat-box {
            background: rgba(212, 175, 55, 0.05);
            border-left: 3px solid var(--gold);
            padding: 10px;
        }
    </style>
</head>
<body>

<div class="container py-4">
    <div class="d-flex justify-content-between align-items-center mb-4">
        <div>
            <h2 class="gold fw-bold m-0"><i class="fas fa-crown"></i> LK STUDIO POS</h2>
            <small class="golden-rose fw-bold">ENV√çO DE TICKET DIGITAL</small>
        </div>
        <span id="fecha-actual" class="badge border border-warning gold p-2"></span>
    </div>

    <div class="row g-4">
        <div class="col-lg-4">
            <div class="card p-4">
                <h5 class="gold mb-4 text-center fw-bold">DATOS DE VENTA</h5>
                
                <div class="mb-3">
                    <label>NOMBRE DE CLIENTA</label>
                    <input id="inputCliente" class="form-control" placeholder="Ej. Maria Lopez">
                </div>

                <div class="mb-3">
                    <label>WHATSAPP (10 D√çGITOS)</label>
                    <input id="inputTel" type="tel" class="form-control" placeholder="5512345678">
                </div>

                <div class="row g-2 mb-3">
                    <div class="col-6">
                        <label>M√âTODO</label>
                        <select id="metodoPago" class="form-select">
                            <option value="Efectivo">Efectivo</option>
                            <option value="Transferencia">Transferencia</option>
                            <option value="Tarjeta">Tarjeta</option>
                        </select>
                    </div>
                    <div class="col-6">
                        <label>PROPINA</label>
                        <input id="inputPropina" type="number" class="form-control" value="0" oninput="renderCarrito()">
                    </div>
                </div>

                <div class="mb-3">
                    <label>AGREGAR SERVICIO</label>
                    <div class="input-group">
                        <select id="selectServicio" class="form-select"></select>
                        <button class="btn btn-gold" onclick="agregarServicio()"><i class="fas fa-plus"></i></button>
                    </div>
                </div>

                <div class="bg-calculadora p-3 border border-secondary rounded mb-4">
                    <div class="d-flex justify-content-between">
                        <span class="golden-rose fw-bold">TOTAL:</span>
                        <h3 class="gold fw-bold m-0">$<span id="displayTotal">0.00</span></h3>
                    </div>
                </div>

                <button class="btn btn-gold w-100 py-3 shadow" onclick="finalizarVenta()">
                    <i class="fas fa-check-circle me-2"></i> FINALIZAR Y ENVIAR
                </button>
            </div>
        </div>

        <div class="col-lg-8">
            <div class="card p-4" style="min-height: 500px;">
                <h5 class="gold fw-bold mb-3">DETALLE DE LA NOTA</h5>
                <div class="table-responsive">
                    <table class="table align-middle">
                        <thead>
                            <tr>
                                <th>DESCRIPCI√ìN</th>
                                <th>PRECIO</th>
                                <th class="text-end">ACCI√ìN</th>
                            </tr>
                        </thead>
                        <tbody id="tablaCarrito"></tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>
</div>

<div class="modal fade" id="modalTicket" tabindex="-1" data-bs-backdrop="static">
    <div class="modal-dialog modal-sm modal-dialog-centered">
        <div class="modal-content" style="background: #111; border: 1px solid var(--gold);">
            <div class="modal-body">
                <div id="ticketPreview" class="animate__animated animate__fadeIn">
                    </div>
                
                <button class="btn btn-whatsapp w-100 mt-3 py-2" onclick="enviarWhatsApp()">
                    <i class="fab fa-whatsapp me-2"></i> ENVIAR A WHATSAPP
                </button>
                <button class="btn btn-outline-light btn-sm w-100 mt-2" onclick="cerrarModal()">NUEVA VENTA</button>
            </div>
        </div>
    </div>
</div>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
<script>
// --- CONFIGURACI√ìN ---
const LOGO_URL = "https://tu-sitio.com/logo-lk-studio.png"; // REEMPLAZA CON EL LINK DE TU LOGO
const servicios = [
    {name:"U√±as Acr√≠licas #2", precio:350},
    {name:"Balayage Elite", precio:2500},
    {name:"Corte Mariposa", precio:180},
    {name:"Pesta√±as Mink", precio:450}
];

let carrito = [];
let ultimaVenta = {};

// Inicializar
document.addEventListener('DOMContentLoaded', () => {
    const selS = document.getElementById("selectServicio");
    servicios.forEach((s, i) => selS.innerHTML += `<option value="${i}">${s.name} ($${s.precio})</option>`);
    document.getElementById("fecha-actual").innerText = new Date().toLocaleDateString();
});

function agregarServicio() {
    const item = servicios[document.getElementById("selectServicio").value];
    carrito.push({ ...item });
    renderCarrito();
}

function eliminarItem(i) {
    carrito.splice(i, 1);
    renderCarrito();
}

function renderCarrito() {
    const tbody = document.getElementById("tablaCarrito");
    tbody.innerHTML = "";
    let subtotal = 0;
    
    carrito.forEach((item, i) => {
        subtotal += item.precio;
        tbody.innerHTML += `
            <tr>
                <td class="text-white">${item.name}</td>
                <td class="gold fw-bold">$${item.precio.toFixed(2)}</td>
                <td class="text-end"><i class="fas fa-trash text-danger" onclick="eliminarItem(${i})"></i></td>
            </tr>`;
    });

    const propina = parseFloat(document.getElementById("inputPropina").value) || 0;
    document.getElementById("displayTotal").innerText = (subtotal + propina).toFixed(2);
}

function finalizarVenta() {
    const cliente = document.getElementById("inputCliente").value;
    const telefono = document.getElementById("inputTel").value;
    
    if(!cliente || carrito.length === 0) return alert("Ingresa nombre de clienta y servicios.");

    const total = document.getElementById("displayTotal").innerText;
    const propina = document.getElementById("inputPropina").value;
    const metodo = document.getElementById("metodoPago").value;
    const hora = new Date().toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' });

    ultimaVenta = { cliente, telefono, total, propina, metodo, hora, items: [...carrito] };

    // Generar Ticket Visual
    let itemsHTML = carrito.map(i => `<div style="display:flex; justify-content:space-between;"><span>${i.name}</span> <span>$${i.precio.toFixed(2)}</span></div>`).join('');
    
    document.getElementById("ticketPreview").innerHTML = `
        <div class="text-center">
            <img src="${LKSTUDIO.png}" class="logo-ticket" onerror="this.style.display='none'">
            <h6 class="fw-bold mb-0">LK STUDIO VIP</h6>
            <small>Citas: +52 744381188 </small>
        </div>
        <hr style="border-top: 1px dashed #000">
        <div>FECHA: ${new Date().toLocaleDateString()}</div>
        <div>CLIENTA: ${cliente.toUpperCase()}</div>
        <hr style="border-top: 1px dashed #000">
        ${itemsHTML}
        <div style="display:flex; justify-content:space-between; margin-top:5px;"><span>Propina:</span> <span>$${parseFloat(propina).toFixed(2)}</span></div>
        <hr style="border-top: 1px dashed #000">
        <div style="display:flex; justify-content:space-between; font-weight:bold; font-size: 1.1rem;">
            <span>TOTAL:</span> <span>$${total}</span>
        </div>
        <div class="text-center mt-3 small">M√âTODO: ${metodo.toUpperCase()}</div>
        <div class="text-center mt-2" style="font-size:0.7rem">¬°Gracias por brillar con nosotros!</div>
    `;

    const modal = new bootstrap.Modal(document.getElementById('modalTicket'));
    modal.show();
}

function enviarWhatsApp() {
    const v = ultimaVenta;
    if(!v.telefono) return alert("Ingresa un n√∫mero de tel√©fono v√°lido");

    // Construir mensaje para WhatsApp con emojis
    let mensaje = `*‚ú® LK STUDIO - TICKET VIP ‚ú®*%0A`;
    mensaje += `-----------------------------------%0A`;
    mensaje += `*Clienta:* ${v.cliente.toUpperCase()}%0A`;
    mensaje += `*Fecha:* ${new Date().toLocaleDateString()} | ${v.hora}%0A`;
    mensaje += `-----------------------------------%0A`;
    
    v.items.forEach(item => {
        mensaje += `‚Ä¢ ${item.name}: $${item.precio.toFixed(2)}%0A`;
    });

    if(parseFloat(v.propina) > 0) mensaje += `‚Ä¢ Propina: $${v.propina}%0A`;
    
    mensaje += `-----------------------------------%0A`;
    mensaje += `*TOTAL A PAGAR: $${v.total}*%0A`;
    mensaje += `*M√©todo:* ${v.metodo}%0A%0A`;
    mensaje += `¬°Gracias por tu preferencia! Te esperamos pronto en LK Studio. üëë`;

    const url = `https://api.whatsapp.com/send?phone=52${v.telefono}&text=${mensaje}`;
    window.open(url, '_blank');
}

function cerrarModal() {
    location.reload(); // Reinicia para nueva venta
}
</script>
</body>
</html>

<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <title>LK Studio | Gestión Académica Pro</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0"> 

    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.1.1/animate.min.css" rel="stylesheet">

    <style>
        :root {
            --gold: #D4AF37;
            --gold-bright: #FFD700;
            --rose: #E6B8A2;
            --deep-black: #050505;
            --grey-row: #1A1A1A; /* Tu gris carbón preferido */
            --sidebar-width: 260px;
        }

        body {
            background: var(--deep-black);
            color: #ffffff;
            font-family: 'Poppins', sans-serif;
            margin: 0;
            display: flex;
            min-height: 100vh;
        }

        /* --- SIDEBAR --- */
        #sidebar {
            width: var(--sidebar-width);
            background: #000;
            border-right: 2px solid var(--gold);
            height: 100vh;
            position: fixed;
            z-index: 1000;
        }

        .nav-link {
            color: #fff !important;
            padding: 15px 25px;
            font-size: 0.85rem;
            text-transform: uppercase;
            transition: 0.3s;
            display: flex;
            align-items: center;
        }

        .nav-link:hover, .nav-link.active {
            background: rgba(212, 175, 55, 0.15);
            border-left: 4px solid var(--gold);
            color: var(--gold-bright) !important;
        }

        /* --- CONTENIDO --- */
        #content {
            width: calc(100% - var(--sidebar-width));
            margin-left: var(--sidebar-width);
            padding: 40px;
        }

        .luxury-font { font-family: 'Cinzel', serif; color: var(--gold); letter-spacing: 2px; }

        /* --- TABLAS GRIS CARBÓN (CON LETRAS BLANCAS) --- */
        .table-custom {
            width: 100%;
            border-collapse: separate;
            border-spacing: 0 12px;
        }

        .table-custom thead th {
            color: var(--rose);
            text-transform: uppercase;
            font-size: 0.75rem;
            padding: 15px;
            border: none;
        }

        .table-custom tbody tr {
            background: var(--grey-row) !important;
            transition: 0.3s;
        }

        .table-custom td {
            padding: 20px !important;
            color: #FFFFFF !important; /* LETRAS SIEMPRE VISIBLES */
            vertical-align: middle;
            border: none;
        }

        .table-custom tr td:first-child { border-radius: 12px 0 0 12px; border-left: 5px solid var(--gold); }
        .table-custom tr td:last-child { border-radius: 0 12px 12px 0; }

        /* --- INPUTS --- */
        .form-control, .form-select {
            background: #000 !important;
            border: 1px solid #333 !important;
            color: var(--gold-bright) !important;
            padding: 12px;
        }

        /* --- IMÁGENES --- */
        .img-thumb {
            width: 60px; height: 60px; object-fit: cover;
            border-radius: 10px; border: 1px solid var(--gold);
        }

        .btn-gold {
            background: linear-gradient(45deg, #b38f1d, var(--gold));
            color: #000; font-weight: 800; border-radius: 50px; border: none;
            padding: 12px 25px;
        }

        .doc-icon { font-size: 1.2rem; margin: 0 5px; cursor: pointer; }
        .exists { color: var(--gold-bright); }
        .missing { color: #444; }
    </style>
</head>
<body>

<nav id="sidebar">
    <div class="p-4 text-center">
        <h4 class="luxury-font">LK STUDIO</h4>
        <small style="color:var(--rose)">SISTEMA ACADÉMICO</small>
    </div>
    <div class="mt-4">
        <a href="javascript:showSection('instructores')" class="nav-link active" id="btn-ins"><i class="fas fa-user-tie me-3"></i> Expedientes</a>
        <a href="javascript:showSection('cursos')" class="nav-link" id="btn-cur"><i class="fas fa-certificate me-3"></i> Catálogo Cursos</a>
        <a href="./PANEL_ADMIN.html" class="nav-link mt-5"><i class="fas fa-sign-out-alt me-3"></i> Volver</a>
    </div>
</nav>

<div id="content">
    
    <section id="sec-instructores" class="animate__animated animate__fadeIn">
        <h2 class="luxury-font mb-4">EXPEDIENTES DE INSTRUCTORES</h2>
        <div class="row g-4">
            <div class="col-md-4">
                <div class="p-4 bg-dark rounded-4 border border-secondary">
                    <h5 class="text-white mb-4">Alta de Instructor</h5>
                    <form id="formIns">
                        <div class="mb-3">
                            <label class="small text-rose">NOMBRE COMPLETO</label>
                            <input type="text" id="ins-nombre" class="form-control" required>
                        </div>
                        <div class="mb-3">
                            <label class="small text-rose">ESPECIALIDAD</label>
                            <input type="text" id="ins-especialidad" class="form-control" required>
                        </div>
                        <div class="mb-3">
                            <label class="small text-rose">INE (FOTO/PDF)</label>
                            <input type="file" id="ins-ine" class="form-control">
                        </div>
                        <button type="submit" class="btn btn-gold w-100">GUARDAR EXPEDIENTE</button>
                    </form>
                </div>
            </div>
            <div class="col-md-8">
                <table class="table-custom">
                    <thead>
                        <tr>
                            <th>Instructor</th>
                            <th>Especialidad</th>
                            <th>Docs</th>
                            <th class="text-end">Acción</th>
                        </tr>
                    </thead>
                    <tbody id="tablaIns"></tbody>
                </table>
            </div>
        </div>
    </section>

    <section id="sec-cursos" class="animate__animated animate__fadeIn" style="display:none;">
        <h2 class="luxury-font mb-4">CATÁLOGO DE CURSOS</h2>
        <div class="row g-4">
            <div class="col-md-4">
                <div class="p-4 bg-dark rounded-4 border border-secondary">
                    <h5 class="text-white mb-4">Nuevo Curso</h5>
                    <form id="formCur">
                        <div class="mb-3">
                            <label class="small text-rose">NOMBRE DEL CURSO</label>
                            <input type="text" id="cur-nombre" class="form-control" required>
                        </div>
                        <div class="mb-3">
                            <label class="small text-rose">INSTRUCTOR ASIGNADO</label>
                            <select id="cur-instructor" class="form-select" required>
                                <option value="">Seleccione Instructor...</option>
                            </select>
                        </div>
                        <div class="mb-3">
                            <label class="small text-rose">FOTO PORTADA</label>
                            <input type="file" id="cur-foto" class="form-control" accept="image/*">
                        </div>
                        <button type="submit" class="btn btn-gold w-100">PUBLICAR CURSO</button>
                    </form>
                </div>
            </div>
            <div class="col-md-8">
                <table class="table-custom">
                    <thead>
                        <tr>
                            <th>Imagen</th>
                            <th>Curso</th>
                            <th>Instructor</th>
                            <th class="text-end">Acción</th>
                        </tr>
                    </thead>
                    <tbody id="tablaCur"></tbody>
                </table>
            </div>
        </div>
    </section>
</div>

<script>
// --- DATOS CENTRALIZADOS ---
let dataInstructores = JSON.parse(localStorage.getItem("LK_INS")) || [];
let dataCursos = JSON.parse(localStorage.getItem("LK_CUR")) || [];

// Convertidor Universal a Base64
const getBase64 = file => new Promise((res, rej) => {
    if(!file) res(null);
    const r = new FileReader();
    r.readAsDataURL(file);
    r.onload = () => res(r.result);
});

// --- LÓGICA DE SECCIONES ---
function showSection(sec) {
    document.getElementById('sec-instructores').style.display = sec === 'instructores' ? 'block' : 'none';
    document.getElementById('sec-cursos').style.display = sec === 'cursos' ? 'block' : 'none';
    document.getElementById('btn-ins').classList.toggle('active', sec === 'instructores');
    document.getElementById('btn-cur').classList.toggle('active', sec === 'cursos');
    if(sec === 'cursos') actualizarSelectInstructores();
}

// --- GESTIÓN DE INSTRUCTORES ---
document.getElementById('formIns').onsubmit = async (e) => {
    e.preventDefault();
    const nuevo = {
        nombre: document.getElementById('ins-nombre').value,
        especialidad: document.getElementById('ins-especialidad').value,
        ine: await getBase64(document.getElementById('ins-ine').files[0])
    };
    dataInstructores.push(nuevo);
    localStorage.setItem("LK_INS", JSON.stringify(dataInstructores));
    e.target.reset();
    renderIns();
};

function renderIns() {
    const t = document.getElementById('tablaIns');
    t.innerHTML = '';
    dataInstructores.forEach((ins, i) => {
        t.innerHTML += `
            <tr>
                <td><b class="text-white">${ins.nombre}</b></td>
                <td><span class="badge bg-outline-gold">${ins.especialidad}</span></td>
                <td><i class="fas fa-file-pdf doc-icon ${ins.ine ? 'exists' : 'missing'}" onclick="verDoc('${ins.ine}')"></i></td>
                <td class="text-end"><button class="btn btn-link text-danger" onclick="delIns(${i})"><i class="fas fa-trash"></i></button></td>
            </tr>`;
    });
}

// --- GESTIÓN DE CURSOS (LA CONEXIÓN) ---
function actualizarSelectInstructores() {
    const sel = document.getElementById('cur-instructor');
    sel.innerHTML = '<option value="">Seleccione Instructor...</option>';
    dataInstructores.forEach(ins => {
        sel.innerHTML += `<option value="${ins.nombre}">${ins.nombre}</option>`;
    });
}

document.getElementById('formCur').onsubmit = async (e) => {
    e.preventDefault();
    const nuevo = {
        nombre: document.getElementById('cur-nombre').value,
        instructor: document.getElementById('cur-instructor').value,
        foto: await getBase64(document.getElementById('cur-foto').files[0])
    };
    dataCursos.push(nuevo);
    localStorage.setItem("LK_CUR", JSON.stringify(dataCursos));
    e.target.reset();
    renderCur();
};

function renderCur() {
    const t = document.getElementById('tablaCur');
    t.innerHTML = '';
    dataCursos.forEach((cur, i) => {
        t.innerHTML += `
            <tr>
                <td><img src="${cur.foto || 'https://via.placeholder.com/60'}" class="img-thumb"></td>
                <td><b class="text-white">${cur.nombre}</b></td>
                <td><i class="fas fa-user-graduate me-2 text-gold"></i>${cur.instructor}</td>
                <td class="text-end"><button class="btn btn-link text-danger" onclick="delCur(${i})"><i class="fas fa-trash"></i></button></td>
            </tr>`;
    });
}

// --- FUNCIONES COMUNES ---
window.verDoc = (b64) => { if(b64) { const w = window.open(); w.document.write(`<iframe src="${b64}" frameborder="0" style="border:0; top:0; left:0; bottom:0; right:0; width:100%; height:100%;" allowfullscreen></iframe>`); } }
window.delIns = (i) => { if(confirm("¿Eliminar instructor?")) { dataInstructores.splice(i,1); localStorage.setItem("LK_INS", JSON.stringify(dataInstructores)); renderIns(); } }
window.delCur = (i) => { if(confirm("¿Eliminar curso?")) { dataCursos.splice(i,1); localStorage.setItem("LK_CUR", JSON.stringify(dataCursos)); renderCur(); } }

// Inicio
renderIns();
renderCur();
</script>

</body>
</html>
